<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Chapter 15: Functions | The Engineering Corner</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Chapter 15: Functions" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Chapter 15: Functions" />
<meta property="og:description" content="Chapter 15: Functions" />
<link rel="canonical" href="http://localhost:4000/bash-in-depth/0015-Functions.html" />
<meta property="og:url" content="http://localhost:4000/bash-in-depth/0015-Functions.html" />
<meta property="og:site_name" content="The Engineering Corner" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-11-17T08:18:26+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Chapter 15: Functions" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-11-17T08:18:26+01:00","datePublished":"2024-11-17T08:18:26+01:00","description":"Chapter 15: Functions","headline":"Chapter 15: Functions","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/bash-in-depth/0015-Functions.html"},"url":"http://localhost:4000/bash-in-depth/0015-Functions.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="The Engineering Corner" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">The Engineering Corner</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
						<a class="page-link" href="/about/">About</a>
            <a class="page-link" href="/bash-in-depth/">Bash In Depth</a>
				</div>
      </nav></div>
</header>

<!--header class="site-header" role="banner">
  <div class="wrapper">
    <a class="site-title" href="/">The Engineering Corner</a>
    <nav class="site-nav">
      <label for="nav-trigger">
        <svg aria-hidden="true" class="icon-menu">
          <use xlink:href="#icon-menu"></use>
        </svg>
      </label>
      <div class="trigger">
          
          <a href="/bash-in-depth/">Bash In Depth</a>
      </div>
    </nav>
  </div>
</header-->

<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Chapter 15: Functions | The Engineering Corner</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Chapter 15: Functions" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Chapter 15: Functions" />
<meta property="og:description" content="Chapter 15: Functions" />
<link rel="canonical" href="http://localhost:4000/bash-in-depth/0015-Functions.html" />
<meta property="og:url" content="http://localhost:4000/bash-in-depth/0015-Functions.html" />
<meta property="og:site_name" content="The Engineering Corner" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-11-17T08:18:26+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Chapter 15: Functions" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-11-17T08:18:26+01:00","datePublished":"2024-11-17T08:18:26+01:00","description":"Chapter 15: Functions","headline":"Chapter 15: Functions","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/bash-in-depth/0015-Functions.html"},"url":"http://localhost:4000/bash-in-depth/0015-Functions.html"}</script>
<!-- End Jekyll SEO tag -->

<div class="chapter-content">
  <h1 id="chapter-15-functions">Chapter 15: Functions</h1>

<h2 id="index">Index</h2>
<ul>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#declaration">Declaration</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#declaration-vs-call">Declaration vs Call</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#local-variables">Local variables</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#overriding-functions-and-commands">Overriding functions and commands</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#variable-funcname-associated-to-a-function">Variable <code class="language-plaintext highlighter-rouge">$FUNCNAME</code> associated to a function</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#positional-parameters">Positional parameters</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#shift-built-in-command"><code class="language-plaintext highlighter-rouge">shift</code> built-in command</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#return-status--and-return">Return status (<code class="language-plaintext highlighter-rouge">$?</code>) and <code class="language-plaintext highlighter-rouge">return</code></a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#returning-non-integer-values">Returning non-integer values</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#recursivity">Recursivity</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#summary">Summary</a></li>
  <li><a href="http://localhost:4000//bash-in-depth/0015-Functions.html#references">References</a></li>
</ul>

<hr style="width:100%;text-align:center;margin-left:0;margin-bottom:10px;" />

<p>Now that we have learnt the basic blocks of Bash we are going to add another layer of abstraction that are… the functions.</p>

<p>In Bash scripting, functions serve as essential building blocks that allow for the modularization and organization of code. A function in Bash is a self-contained block of code that performs a specific task, and it can be invoked or called from anywhere within the script. This modular approach not only enhances code readability but also promotes code reuse, making scripts more efficient and maintainable.</p>

<p>To declare a function in Bash, the “<code class="language-plaintext highlighter-rouge">function</code>” keyword or a shorthand syntax with parentheses is used, followed by the function name and the curly braces that encapsulate the function body. Functions may or may not receive arguments, allowing for flexibility in handling input parameters. Additionally, they can return values to the calling code, contributing to the versatility of Bash scripts.</p>

<p>Functions in Bash enable the creation of structured and organized scripts by encapsulating specific functionalities. As we go deeper into Bash scripting, we will explore the syntax, parameters, return values, and best practices for utilizing functions. Understanding how to leverage functions enhances the efficiency and readability of Bash scripts, contributing to the development of robust and maintainable automation solutions.</p>

<h2 id="declaration">Declaration</h2>

<p>In Bash scripting, declaring a function involves specifying the function’s name, defining its behavior or code block, and optionally providing parameters that the function can accept. The syntax for declaring a function is straightforward and can be done using either the “<code class="language-plaintext highlighter-rouge">function</code>” keyword or a concise shorthand notation.</p>

<div style="text-align:center">
    <img src="/assets/bash-in-depth/0015-Functions/Function-Declaration.png" width="450px" />
</div>

<p>Let’s see next a couple of examples of how to declare a function.</p>

<p>The first example is by using the “<code class="language-plaintext highlighter-rouge">function</code>” keyword.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c"># Script: function-0001.sh</span>
 3 <span class="k">function </span>my_function<span class="o">()</span> <span class="o">{</span>
 4     <span class="nb">echo</span> <span class="s2">"Hello from inside the function"</span>
 5 <span class="o">}</span>
 6 my_function
</code></pre></div></div>

<p>When you run the previous script you get the following output.</p>

<pre><code class="language-txt">$ ./function-0001.sh
Hello from inside the function
</code></pre>

<p>And the second example is by declaring the function without the “<code class="language-plaintext highlighter-rouge">function</code>” keyword, like the following script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c"># Script: function-0002.sh</span>
 3 my_function<span class="o">()</span> <span class="o">{</span>
 4     <span class="nb">echo</span> <span class="s2">"Hello from inside the function"</span>
 5 <span class="o">}</span>
 6 my_function
</code></pre></div></div>

<p>If you run the last script you will see that it produces the same output as the “<code class="language-plaintext highlighter-rouge">function-0002.sh</code>” script.</p>

<p>Although both approaches are equivalent, the second one (without the “<code class="language-plaintext highlighter-rouge">function</code>” keyword) is more portable and because of portability reasons it will be the approach that we will use in this book.</p>

<p>Something to notice is that a function <strong>can NEVER have an empty body</strong>. For example, if we try to execute the following script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c"># Script: function-0003.sh</span>
 3 error_fn_1<span class="o">()</span> <span class="o">{</span>
 4 <span class="o">}</span>
 5 error_fn_2<span class="o">()</span> <span class="o">{</span>
 6     <span class="nb">echo</span> <span class="s2">"Some commands"</span>
 7 <span class="o">}</span>
</code></pre></div></div>

<p>If you try to run the previous script you will get the following error.</p>

<pre><code class="language-txt">$ ./function-0003.sh
./function-0003.sh: line 4: syntax error near unexpected token `}'
./function-0003.sh: line 4: `}'
</code></pre>

<p>The body of a function must contain any combination of commands and statements like the ones we learnt before (<code class="language-plaintext highlighter-rouge">if</code>, <code class="language-plaintext highlighter-rouge">case</code>, <code class="language-plaintext highlighter-rouge">for</code> loop, <code class="language-plaintext highlighter-rouge">while</code> loop,…). You have to write code that is clean so that you can understand it when you come back to it.</p>

<p>In the next sections we will dive into different details of functions. We will start by comparing declaration vs call of a function.</p>

<h2 id="declaration-vs-call">Declaration vs Call</h2>

<p>In Bash scripting you cannot call a function unless it has been previously declared. Bear in mind that declaring and calling a function are two different things. You can declare functions that call other functions/commands and it will work as long as at the moment of the execution the commands/functions are available to the script.</p>

<p>Let’s see what happens when you try to invoke a function that has not been declared before the call.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c"># Script: function-0004.sh</span>
 3 my_function <span class="c"># not declared before execution</span>
 4 my_function<span class="o">()</span> <span class="o">{</span>
 5     <span class="nb">echo</span> <span class="s2">"My function"</span>
 6 <span class="o">}</span>
</code></pre></div></div>

<p>When you run the previous script you will receive the following error.</p>

<pre><code class="language-txt">$ ./function-0004.sh
./function-0004.sh: line 3: my_function: command not found
</code></pre>

<p>Now if you swap the order having the function declared before the call of the function, everything works.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c"># Script: function-0005.sh</span>
 3 my_function<span class="o">()</span> <span class="o">{</span>
 4     <span class="nb">echo</span> <span class="s2">"My function"</span>
 5 <span class="o">}</span>
 6 my_function
</code></pre></div></div>

<p>When you execute the last script you will get a successful execution.</p>

<pre><code class="language-txt">$ ./function-0005.sh
My function
</code></pre>

<p>In the following example you will see that there are two functions being declared which are “<code class="language-plaintext highlighter-rouge">my_function_1</code>” and “<code class="language-plaintext highlighter-rouge">my_function_2</code>”. You will also notice that “<code class="language-plaintext highlighter-rouge">my_function_1</code>” invokes “<code class="language-plaintext highlighter-rouge">my_function_2</code>”, which is declared <strong>after</strong> “<code class="language-plaintext highlighter-rouge">my_function_1</code>”.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c"># Script: function-0006.sh</span>
 3 my_function_1<span class="o">()</span> <span class="o">{</span>
 4     <span class="nb">echo</span> <span class="s2">"Inside my_function_1"</span>
 5     my_function_2
 6 <span class="o">}</span>
 7 my_function_2<span class="o">()</span> <span class="o">{</span>
 8     <span class="nb">echo</span> <span class="s2">"Inside my_function_2"</span>
 9 <span class="o">}</span>
10 my_function_1
</code></pre></div></div>

<p>This is OK because by the time Bash executes “<code class="language-plaintext highlighter-rouge">my_function_1</code>” all the information needed by it to execute successfully (in our case, declaration of “<code class="language-plaintext highlighter-rouge">my_function_2</code>”) is available in memory/context.</p>

<p>If you execute the previous script you will get the following output.</p>

<pre><code class="language-txt">$ ./function-0006.sh
Inside my_function_1
Inside my_function_2
</code></pre>

<p>In the same way that a Bash script can have variables, a function can have as well variables that are called “<em>local variables</em>”. In the next section we will talk about local variables.</p>

<h2 id="local-variables">Local variables</h2>
<p>What is the “<strong>scope</strong>” of a variable? <em>The scope of a variable is the context in which it has meaning, in which it has a value that can be referenced</em>. For example, the scope of a local variable lies only within the function, block of code (<code class="language-plaintext highlighter-rouge">{...}</code>), or subshell (we will talk later in the book) within which it is defined, while the scope of a global variable is the entire script in which it appears.</p>

<p>A variable declared as “<code class="language-plaintext highlighter-rouge">local</code>” is one that is visible only within the block of code in which it appears. If a variable within a function is not declared as local, global scope will be by default.</p>

<p>Before a function is called, all variables declared within the function <strong>are invisible outside the body of the function</strong>, not just those explicitly declared as “<code class="language-plaintext highlighter-rouge">local</code>”.</p>

<p>Let’s see how it works with the following example script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c"># Script: function-0007.sh</span>
 3 custom1<span class="o">()</span> <span class="o">{</span>
 4     <span class="nb">local </span><span class="nv">localVar</span><span class="o">=</span>324
 5     <span class="nv">globalVar</span><span class="o">=</span>123
 6     <span class="nb">echo</span> <span class="s2">"localVar: </span><span class="nv">$localVar</span><span class="s2">"</span>
 7     <span class="nb">echo</span> <span class="s2">"Done with </span><span class="nv">$FUNCNAME</span><span class="s2">"</span>
 8 <span class="o">}</span>
 9 <span class="nb">echo</span> <span class="s2">"Local variable before function: </span><span class="nv">$localVar</span><span class="s2">"</span>
10 <span class="nb">echo</span> <span class="s2">"Global variable before function: </span><span class="nv">$globalVar</span><span class="s2">"</span>
11 custom1
12 <span class="nb">echo</span> <span class="s2">"Local variable after function: </span><span class="nv">$localVar</span><span class="s2">"</span>
13 <span class="nb">echo</span> <span class="s2">"Global variable after function: </span><span class="nv">$globalVar</span><span class="s2">"</span>
</code></pre></div></div>

<p>When you execute the previous script you will have the following output in the terminal window.</p>

<pre><code class="language-txt">$ ./function-0007.sh
Local variable before function:
Global variable before function:
localVar: 324
Done with custom1
Local variable after function:
Global variable after function: 123
</code></pre>

<p>So, what is happening in the execution of this script? When the script reaches lines 9 and 10 it just prints the string without the content of the variables. This is because there is no information about the variables at this point.</p>

<p>Then, on line 11 the function “<code class="language-plaintext highlighter-rouge">custom1</code>” is executed. Inside the function there are 2 variables. The first variable is a local variable named “<code class="language-plaintext highlighter-rouge">localVar</code>” whose scope is the function itself and it will not be available outside the function. The second variable, named “<code class="language-plaintext highlighter-rouge">globalVar</code>”, is a global variable (as the “<code class="language-plaintext highlighter-rouge">local</code>” keyword was not used, global scope is the default one) that, once the function is executed, will be available to the rest of the script.</p>

<p>Once the execution of the function is done you see that only the global variable is present in the output.</p>

<h2 id="overriding-functions-and-commands">Overriding functions and commands</h2>

<p>In Bash you can override the declaration of a function (or a command) by declaring a new function <strong>with the same exact name</strong>.</p>

<p>The way it works is once the functions (or commands) are available inside the script you are working on, you can add a function with the same name as the function (or command) you want to override and from that moment the overriding will work.</p>

<p>To summarize, <strong>the latest declaration wins</strong>.</p>

<p>Let’s see how it works with a couple of examples to show how we can override functions (or commands).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c"># Script: function-0008.sh</span>
 3 my_function_1<span class="o">()</span> <span class="o">{</span>
 4     <span class="nb">echo</span> <span class="s2">"Inside my_function_1 - 1"</span>
 5 <span class="o">}</span>
 6 my_function_1<span class="o">()</span> <span class="o">{</span> <span class="c"># Will override the previous declaration</span>
 7     <span class="nb">echo</span> <span class="s2">"Inside the override of my_function_1"</span>
 8 <span class="o">}</span>
 9 my_function_1
</code></pre></div></div>

<p>As you can see in the previous script the function is declared twice, as we mentioned before the second declaration (the latest one) will be the one that will be used.</p>

<p>If you execute the previous script you get the following result.</p>

<pre><code class="language-txt">$ ./function-0008.sh
Inside the override of my_function_1
</code></pre>
<p>As you can see from the execution the second declaration of the function “<code class="language-plaintext highlighter-rouge">my_function_1</code>” is the one that got executed.</p>

<p>Now that we know how to override functions, let’s try to do the same with commands.</p>

<p>In the following example we are going to override the command “<code class="language-plaintext highlighter-rouge">ls</code>”<a id="footnote-1-ref" href="#footnote-1" style="font-size:x-small">[1]</a>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c">#Script: function-0009.sh</span>
 3 <span class="nb">echo</span> <span class="s2">"Before overriding"</span>
 4 <span class="nb">echo</span> <span class="s2">"##########"</span>
 5 <span class="nb">ls</span>  <span class="c"># standard command 'ls'. Will print directory content</span>
 6 <span class="nb">echo</span> <span class="s2">""</span>
 7 <span class="nb">ls</span><span class="o">()</span> <span class="o">{</span> <span class="c"># Overriding command 'ls'</span>
 8     <span class="nb">echo</span> <span class="s2">"Nothing to see here"</span>
 9 <span class="o">}</span>
10 <span class="nb">echo</span> <span class="s2">"After overriding"</span>
11 <span class="nb">echo</span> <span class="s2">"##########"</span>
12 <span class="nb">ls</span>   <span class="c"># Will print "Nothing to see here"</span>
13 <span class="nb">echo</span> <span class="s2">""</span>
</code></pre></div></div>

<p>In the previous script, on line 5, the actual “<code class="language-plaintext highlighter-rouge">ls</code>” command is used to list the contents of the current folder. Later between lines 7 and 9 we do declare a function with the name “<code class="language-plaintext highlighter-rouge">ls</code>” to be able to override the command “<code class="language-plaintext highlighter-rouge">ls</code>”.</p>

<p>When you run the previous script you will get the following result in the terminal window.</p>

<pre><code class="language-txt">$ ./function-0009.sh
Before overriding
##########
function-0001.sh  function-0003.sh  function-0005.sh  function-0007.sh  function-0009.sh
function-0002.sh  function-0004.sh  function-0006.sh  function-0008.sh

After overriding
##########
Nothing to see here
</code></pre>

<p>As you can see in the execution of the last script before line 7 of the script the actual “<code class="language-plaintext highlighter-rouge">ls</code>” command is used. After line 7 the function is the one used.</p>

<h2 id="variable-funcname-associated-to-a-function">Variable <code class="language-plaintext highlighter-rouge">$FUNCNAME</code> associated to a function</h2>

<p>The variable “<code class="language-plaintext highlighter-rouge">FUNCNAME</code>” is an array containing the names of all shell functions currently in the execution call stack. The element with index 0 is the name of any currently-executing shell function. The bottom-most element (the one with the highest index) is “<code class="language-plaintext highlighter-rouge">main</code>“<a id="footnote-2-ref" href="#footnote-2" style="font-size:x-small">[2]</a>. This variable exists only when a shell function is executing. Assignments to “<code class="language-plaintext highlighter-rouge">FUNCNAME</code>” have no effect. If “<code class="language-plaintext highlighter-rouge">FUNCNAME</code>” is unset, it loses its special properties, even if it is subsequently reset.</p>

<p>Let’s see how it works with the following example script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c">#Script: function-0010.sh</span>
 3 my_custom_function<span class="o">()</span> <span class="o">{</span>
 4     <span class="nb">echo</span> <span class="s2">"We are inside the function '</span><span class="nv">$FUNCNAME</span><span class="s2">'"</span>
 5     <span class="nb">echo</span> <span class="s2">"Array: </span><span class="k">${</span><span class="nv">FUNCNAME</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span>
 6     my_custom_function_2
 7 <span class="o">}</span>
 8 my_custom_function_2<span class="o">()</span> <span class="o">{</span>
 9     <span class="nb">echo</span> <span class="s2">"Array: </span><span class="k">${</span><span class="nv">FUNCNAME</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span>
10     my_custom_function_3
11 <span class="o">}</span>
12 my_custom_function_3<span class="o">()</span> <span class="o">{</span>
13     <span class="nb">echo</span> <span class="s2">"Array: </span><span class="k">${</span><span class="nv">FUNCNAME</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span>
14 <span class="o">}</span>
15 my_custom_function
16 <span class="nb">echo</span> <span class="s2">"End"</span>
</code></pre></div></div>

<p>If you run the previous script you will see the following output in the terminal window.</p>

<pre><code class="language-txt">$ ./function-0010.sh
We are inside the function 'my_custom_function'
Array: my_custom_function main
Array: my_custom_function_2 my_custom_function main
Array: my_custom_function_3 my_custom_function_2 my_custom_function main
End
</code></pre>

<h2 id="positional-parameters">Positional parameters</h2>

<p>This section is going to be very useful because what we will learn here is applicable to both functions and scripts.</p>

<p>Till now we learnt how to write functions and scripts that execute a task without receiving anything from the caller. Now we are going to learn how we can pass arguments to a function/script so that it can be used as parameters.</p>

<p>What is the difference between arguments and parameters? To be on the same page we are going to use the notions that appear on this page of Developer Mozilla<a id="footnote-3-ref" href="#footnote-3" style="font-size:x-small">[3]</a>.</p>

<p>Note the difference between parameters and arguments:</p>
<ul>
  <li>Function parameters are the names listed in the function’s definition.</li>
  <li>Function arguments are the real values passed to the function.
    <ul>
      <li>An argument is a value passed as input to a function.</li>
    </ul>
  </li>
  <li>Parameters are initialized to the values of the arguments supplied.</li>
</ul>

<p>All information we can have regarding positional parameters come inside the following variables:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">$0</code>, <code class="language-plaintext highlighter-rouge">$1</code>, <code class="language-plaintext highlighter-rouge">$2</code>, etc: Positional parameters, passed from command line to script or passed to a function.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">$0</code> is a “<em>special value</em>” and it’s <strong>ALWAYS</strong> going to be the name of the script being executed in the way you wrote it (relative path, absolute path, etc)</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">$#</code>: Number of command-line arguments or positional parameters</li>
  <li><code class="language-plaintext highlighter-rouge">$*</code>: All of the positional parameters, seen as a single word (it must be quoted , “<code class="language-plaintext highlighter-rouge">$*</code>”)</li>
  <li><code class="language-plaintext highlighter-rouge">$@</code>: Same as <code class="language-plaintext highlighter-rouge">$*</code>, but each parameter is a quoted string, that is, the parameters are passed on intact, without interpretation or expansion. This means, among other things, that each parameter in the argument list is seen as a separate word.</li>
</ul>

<h2 id="shift-built-in-command"><code class="language-plaintext highlighter-rouge">shift</code> built-in command</h2>

<p>The “<code class="language-plaintext highlighter-rouge">shift</code>” command is one of the Bourne shell built-ins that comes with Bash. This command takes one argument, a number. The positional parameters are shifted to the left by this number, <code class="language-plaintext highlighter-rouge">N</code>. The positional parameters from <code class="language-plaintext highlighter-rouge">N+1</code> to <code class="language-plaintext highlighter-rouge">$#</code> are renamed to variable names from <code class="language-plaintext highlighter-rouge">$1</code> to <code class="language-plaintext highlighter-rouge">$# - N+1</code>.</p>

<p>Say you have a command that takes 10 arguments, and <code class="language-plaintext highlighter-rouge">N</code> is 4, then <code class="language-plaintext highlighter-rouge">$4</code> becomes <code class="language-plaintext highlighter-rouge">$1</code>, <code class="language-plaintext highlighter-rouge">$5</code> becomes <code class="language-plaintext highlighter-rouge">$2</code> and so on. <code class="language-plaintext highlighter-rouge">$10</code> becomes <code class="language-plaintext highlighter-rouge">$7</code> and the original <code class="language-plaintext highlighter-rouge">$1</code>, <code class="language-plaintext highlighter-rouge">$2</code> and <code class="language-plaintext highlighter-rouge">$3</code> <strong>are thrown away</strong>.</p>

<p>If <code class="language-plaintext highlighter-rouge">N</code> is zero or greater than <code class="language-plaintext highlighter-rouge">$#</code>, the positional parameters are not changed and the command has no effect. If <code class="language-plaintext highlighter-rouge">N</code> is not present, <strong>it is assumed to be 1</strong>. The return status is zero unless <code class="language-plaintext highlighter-rouge">N</code> is greater than <code class="language-plaintext highlighter-rouge">$#</code> or less than zero; otherwise it is non-zero.</p>

<p>Let’s see how the “<code class="language-plaintext highlighter-rouge">shift</code>” command works with the following example.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c">#Script: function-0011.sh</span>
 3 <span class="nv">args</span><span class="o">=(</span><span class="nv">$@</span><span class="o">)</span>
 4 <span class="nb">echo</span> <span class="s2">"Printing original list of arguments"</span>
 5 <span class="k">for</span><span class="o">((</span><span class="nv">index</span><span class="o">=</span>0<span class="p">;</span> index &lt;<span class="o">=</span> <span class="k">${#</span><span class="nv">args</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span> index++<span class="o">))</span> <span class="o">{</span>
 6     <span class="nb">echo</span> <span class="s2">"Arg[</span><span class="nv">$index</span><span class="s2">]: </span><span class="k">${</span><span class="p">!index</span><span class="k">}</span><span class="s2">"</span>
 7 <span class="o">}</span>
 8 <span class="nb">shift </span>4
 9 <span class="nv">args</span><span class="o">=(</span><span class="nv">$@</span><span class="o">)</span>
10 <span class="nb">echo</span> <span class="s2">"Printing list after shifting"</span>
11 <span class="k">for</span><span class="o">((</span><span class="nv">index</span><span class="o">=</span>0<span class="p">;</span> index &lt;<span class="o">=</span> <span class="k">${#</span><span class="nv">args</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span> index++<span class="o">))</span> <span class="o">{</span>
12     <span class="nb">echo</span> <span class="s2">"Arg[</span><span class="nv">$index</span><span class="s2">]: </span><span class="k">${</span><span class="p">!index</span><span class="k">}</span><span class="s2">"</span>
13 <span class="o">}</span>
</code></pre></div></div>

<p>When you execute the previous script with the numbers from 1 to 9 you will get the following output.</p>

<pre><code class="language-txt">$ ./function-0011.sh
Printing original list of arguments
Arg[0]: ./function-0011.sh
Arg[1]: 1
Arg[2]: 2
Arg[3]: 3
Arg[4]: 4
Arg[5]: 5
Arg[6]: 6
Arg[7]: 7
Arg[8]: 8
Arg[9]: 9
Printing list after shifting
Arg[0]: ./function-0011.sh
Arg[1]: 5
Arg[2]: 6
Arg[3]: 7
Arg[4]: 8
Arg[5]: 9
</code></pre>

<p>Pay attention to a few things:</p>
<ul>
  <li>Parameter <code class="language-plaintext highlighter-rouge">$0</code>, as we mentioned previously, it’s always the name of the script</li>
  <li>Arguments from index 1 to index 4 were <strong>discarded</strong></li>
  <li>Arguments from index 5 to index 9 were moved to indices 1 to 5</li>
</ul>

<h2 id="return-status--and-return">Return status (<code class="language-plaintext highlighter-rouge">$?</code>) and <code class="language-plaintext highlighter-rouge">return</code></h2>

<p>In Bash, every function and script “<em>returns</em>” a value which is an integer. For that, the keyword “<code class="language-plaintext highlighter-rouge">return</code>” tends to be used.</p>

<p>Once the result is returned from the function and the scope of the function is over, the result will be stored in the variable “<code class="language-plaintext highlighter-rouge">$?</code>” which will always contain the return value (integer) of the last statement or function or script executed.</p>

<p>Let’s see how it works with an example.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c">#Script: function-0012.sh</span>
 3 <span class="c"># Declaring a function</span>
 4 my_ok_function<span class="o">()</span> <span class="o">{</span>
 5     <span class="nb">echo</span> <span class="s2">"This function returns zero"</span>
 6     <span class="k">return </span>0 
 7 <span class="o">}</span>
 8 <span class="c"># Invoking the function</span>
 9 my_ok_function
10 <span class="c"># Printing the result of the function</span>
11 <span class="nb">echo</span> <span class="s2">"Result: </span><span class="nv">$?</span><span class="s2">"</span>
</code></pre></div></div>

<p>When you run the previous script you will have the following output in the terminal window.</p>

<pre><code class="language-txt">$ ./function-0012.sh
This function returns zero
Result: 0
</code></pre>

<p>As you already saw the script printed “<code class="language-plaintext highlighter-rouge">Result: 0</code>” to the output. Something to be aware of is that the “<code class="language-plaintext highlighter-rouge">return</code>” keyword <strong>only accepts an integer in the range [0-255]</strong>. If an integer beyond this range is specified its binary value will be truncated to what 8 bits allow. For example:</p>
<ul>
  <li>If 256 is specified, the actual value will be zero</li>
  <li>If 257 is specified, the actual value will be 1</li>
  <li>If -1 is specified, the actual value will be 255</li>
  <li>If -2 is specified, the actual value will be 254</li>
  <li>And so on.</li>
</ul>

<p>If no “<code class="language-plaintext highlighter-rouge">return</code>” keyword is specified in the return of a function, the value returned will be the return value of the last command in the function.</p>

<p>You can see “<code class="language-plaintext highlighter-rouge">return</code>” as the way to signal the exit status of a function.</p>

<p>Once the result is returned from the function and the scope of the function is over, the result will be stored in the variable “<code class="language-plaintext highlighter-rouge">$?</code>” which will always contain the return value (integer) of the last statement or function or script executed.</p>

<h2 id="returning-non-integer-values">Returning non-integer values</h2>

<p>As we saw before, the keyword “<code class="language-plaintext highlighter-rouge">return</code>” is used to terminate the execution of the current function with a specific status code [0-255]. “<code class="language-plaintext highlighter-rouge">return</code>” cannot be used to return other values apart from integers in the specified range. In order to “<code class="language-plaintext highlighter-rouge">return</code>” other kinds of values we need to use another builtin command we learnt already, which is the “<code class="language-plaintext highlighter-rouge">echo</code>” command.</p>

<p>Let’s see how it works with the following example.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./function-0013.sh
Result is <span class="s1">'NON_INTEGER_VALUE'</span>
</code></pre></div></div>

<p>The previous script will printed “<code class="language-plaintext highlighter-rouge">Result is ‘NON_INTEGER_VALUE’</code>” to the screen. But you could be more creative by creating JSON strings, XML strings and so much more!</p>

<h2 id="recursivity">Recursivity</h2>

<p>In computer science, recursion is a programming technique using a function or an algorithm that calls itself one or more times until a specified condition is met, time at which the rest of each repetition is processed from the last one called to the first.</p>

<p>Let’s see how it works with the following example script that implements the Fibonacci<a id="footnote-4-ref" href="#footnote-4" style="font-size:x-small">[4]</a> function.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c">#Script: function-0014.sh</span>
 3 <span class="c"># Declaring the Fibonacci function</span>
 4 fibonacci<span class="o">()</span> <span class="o">{</span>
 5     <span class="nv">nthTerm</span><span class="o">=</span><span class="nv">$1</span>
 6     <span class="k">if</span> <span class="o">[</span> <span class="nv">$nthTerm</span> <span class="nt">-eq</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="c"># F(0)</span>
 7         <span class="nb">echo </span>0
 8     <span class="k">elif</span> <span class="o">[</span> <span class="nv">$nthTerm</span> <span class="nt">-eq</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="c"># F(1)</span>
 9         <span class="nb">echo </span>1
10     <span class="k">else</span> <span class="c"># F(N-1) + F(N-2)</span>
11         <span class="nb">local </span><span class="nv">n1</span><span class="o">=</span><span class="k">$((</span><span class="nv">$nthTerm</span> <span class="o">-</span> <span class="m">1</span><span class="k">))</span>
12         <span class="nb">local </span><span class="nv">fn1</span><span class="o">=</span><span class="si">$(</span>fibonacci <span class="nv">$n1</span><span class="si">)</span>
13         <span class="nb">local </span><span class="nv">n2</span><span class="o">=</span><span class="k">$((</span><span class="nv">$nthTerm</span> <span class="o">-</span> <span class="m">2</span><span class="k">))</span>
14         <span class="nb">local </span><span class="nv">fn2</span><span class="o">=</span><span class="si">$(</span>fibonacci <span class="nv">$n2</span><span class="si">)</span>
15         <span class="nb">echo</span> <span class="k">$((</span><span class="nv">$fn1</span> <span class="o">+</span> <span class="nv">$fn2</span><span class="k">))</span>
16     <span class="k">fi
</span>17 <span class="o">}</span>
18 <span class="c"># Calling the Fibonacci function with the number 10</span>
19 fibonacci 10
</code></pre></div></div>

<p>When you run the previous script you will see the following the terminal window.</p>

<pre><code class="language-txt">$ ./function-0014.sh
55
</code></pre>

<p>Just for the record, recursivity is not only specific to functions. It’s a concept that can be used at script level.</p>

<p>The previous function could be written as the following so that the recursion is applied to the script itself.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 <span class="c">#!/usr/bin/env bash</span>
 2 <span class="c">#Script: function-0015.sh</span>
 3 <span class="nv">nthTerm</span><span class="o">=</span><span class="nv">$1</span>
 4 <span class="k">if</span> <span class="o">[</span> <span class="nv">$nthTerm</span> <span class="nt">-eq</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="c"># F(0)</span>
 5     <span class="nb">echo </span>0
 6 <span class="k">elif</span> <span class="o">[</span> <span class="nv">$nthTerm</span> <span class="nt">-eq</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="c"># F(1)</span>
 7     <span class="nb">echo </span>1
 8 <span class="k">else</span> <span class="c"># F(N-1) + F(N-2)</span>
 9     <span class="nv">n1</span><span class="o">=</span><span class="k">$((</span><span class="nv">$nthTerm</span> <span class="o">-</span> <span class="m">1</span><span class="k">))</span>
10     <span class="nv">fn1</span><span class="o">=</span><span class="si">$(</span><span class="nv">$0</span> <span class="nv">$n1</span><span class="si">)</span> <span class="c"># script calling itself</span>
11     <span class="nv">n2</span><span class="o">=</span><span class="k">$((</span><span class="nv">$nthTerm</span> <span class="o">-</span> <span class="m">2</span><span class="k">))</span>
12     <span class="nv">fn2</span><span class="o">=</span><span class="si">$(</span><span class="nv">$0</span> <span class="nv">$n2</span><span class="si">)</span> <span class="c"># script calling itself</span>
13     <span class="nb">echo</span> <span class="k">$((</span><span class="nv">$fn1</span> <span class="o">+</span> <span class="nv">$fn2</span><span class="k">))</span>
14 <span class="k">fi</span>
</code></pre></div></div>

<p>When you run the previous script providing 10 as input it will generate the same output as the previous script.</p>

<pre><code class="language-txt">$ ./function-0015.sh
55
</code></pre>

<p>You will notice that takes a bit longer for the script to be executed because it’s creating different processes<a id="footnote-5-ref" href="#footnote-5" style="font-size:x-small">[5]</a>.</p>

<h2 id="summary">Summary</h2>

<p>In this electrifying chapter, we dove headfirst into one of the most powerful tools in a Bash scripter’s arsenal: <strong>functions</strong>! Functions allow us to streamline our scripts, making them more efficient, reusable, and easy to maintain. We explored how functions are declared and discovered that simply declaring them isn’t enough — they only spring into action when explicitly called. This distinction is crucial for building more complex scripts, where we can define logic once and call it as many times as needed!</p>

<p>We also uncovered the beauty of <strong>local variables</strong> inside functions, which keep our code clean and isolated, preventing conflicts with global variables. This not only improves readability but also ensures that our functions don’t unintentionally mess up other parts of the script. Then came the mind-blowing revelation: <strong>overriding functions</strong> and <strong>even commands</strong>! That’s right — with a little creativity, you can redefine how certain commands work in your script, but with great power comes great responsibility!</p>

<p>One of the most intriguing topics covered was the <strong><code class="language-plaintext highlighter-rouge">$FUNCNAME</code> variable</strong>, a hidden gem that helps you track the function call stack. It provides a look under the hood when debugging or working with nested functions. To round things off, we dove into <strong>positional parameters</strong> and the game-changing <strong><code class="language-plaintext highlighter-rouge">shift</code> built-in command</strong>, which lets us control how arguments are passed and managed within functions. Mastering these concepts opens the door to writing flexible, adaptable scripts that can handle any input thrown their way. This chapter was a true exploration of the versatility and power of functions in Bash!</p>

<h2 id="references">References</h2>

<ol>
  <li><a href="https://linux101.hashnode.dev/bash-function-return-value-a-beginners-guide">https://linux101.hashnode.dev/bash-function-return-value-a-beginners-guide</a></li>
  <li><a href="https://linuxize.com/post/bash-functions/">https://linuxize.com/post/bash-functions/</a></li>
  <li><a href="https://phoenixnap.com/kb/bash-function">https://phoenixnap.com/kb/bash-function</a></li>
  <li><a href="https://ryanstutorials.net/bash-scripting-tutorial/bash-functions.php">https://ryanstutorials.net/bash-scripting-tutorial/bash-functions.php</a></li>
  <li><a href="https://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO-8.html">https://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO-8.html</a></li>
  <li><a href="https://www.gnu.org/software/bash/manual/html_node/Shell-Functions.html">https://www.gnu.org/software/bash/manual/html_node/Shell-Functions.html</a></li>
  <li><a href="https://www.shell-tips.com/bash/functions/#gsc.tab=0">https://www.shell-tips.com/bash/functions/#gsc.tab=0</a></li>
</ol>

<hr style="width:100%;text-align:center;margin-left:0;margin-bottom:10px;" />

<p id="footnote-1" style="font-size:10pt">
1. The “<code style="font-size:10pt">ls</code>” command is used to list the content of the folders that you pass as arguments, or the current folder if you do not provide any argument.<a href="#footnote-1-ref">&#8617;</a>
</p>
<p id="footnote-2" style="font-size:10pt">
2. "<code style="font-size:10pt">main</code>" represents the global (non-function) execution context of the Bash script.<a href="#footnote-2-ref">&#8617;</a>
</p>
<p id="footnote-3" style="font-size:10pt">
3. <a href="https://developer.mozilla.org/en-US/docs/Glossary/Parameter">https://developer.mozilla.org/en-US/docs/Glossary/Parameter</a> <a href="#footnote-3-ref">&#8617;</a>
</p>
<p id="footnote-4" style="font-size:10pt">
4. <a href="https://en.wikipedia.org/wiki/Fibonacci_sequence">https://en.wikipedia.org/wiki/Fibonacci_sequence</a><a href="#footnote-4-ref">&#8617;</a>
</p>
<p id="footnote-5" style="font-size:10pt">
5. We will speak about processes in a later chapter.<a href="#footnote-5-ref">&#8617;</a>
</p>


</div>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">The Engineering Corner</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">The Engineering Corner</li><li><a class="u-email" href="mailto:the.engineering.corner.314@gmail.com">the.engineering.corner.314@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>I hope you will have fun and learn new things reading this blog.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
